# Phase 1 PoCæ¤œè¨¼ãƒ¬ãƒãƒ¼ãƒˆ: èªå½™ãƒ¬ãƒ™ãƒ«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 

**å®Ÿæ–½æ—¥**: 2025-11-11  
**æ‰€è¦æ™‚é–“**: ç´„5æ™‚é–“  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… **æˆåŠŸ**

---

## ğŸ“‹ ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼

Phase 1 PoCï¼ˆèªå½™ãƒ¬ãƒ™ãƒ«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ï¼‰ã‚’å®Ÿè£…ã—ã€**æŠ€è¡“çš„å®Ÿç¾å¯èƒ½æ€§ã‚’ç¢ºèª**ã—ã¾ã—ãŸã€‚

### ä¸»è¦æˆæœ

1. âœ… **èªå½™è¾æ›¸ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰å®Œäº†**ï¼ˆ47èªã®å®Ÿãƒ‡ãƒ¼ã‚¿ã§æ¤œè¨¼ï¼‰
2. âœ… **Lemmatizationå®Ÿè£…æˆåŠŸ**ï¼ˆ`compromise`ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä½¿ç”¨ï¼‰
3. âœ… **èªå½™ãƒ¬ãƒ™ãƒ«æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯å‹•ä½œç¢ºèª**ï¼ˆ3%ãƒ«ãƒ¼ãƒ«é©ç”¨ï¼‰
4. âœ… **æ—¢å­˜å•é¡Œç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ ã¸ã®çµ±åˆå®Œäº†**
5. âœ… **ãƒ†ã‚¹ãƒˆå®Ÿè¡ŒæˆåŠŸ**ï¼ˆ3ç´šãƒ»æº–1ç´šã§æ¤œè¨¼ï¼‰

### çµè«–

**Phase 1ã¯æŠ€è¡“çš„ã«å®Ÿç¾å¯èƒ½ã§ã‚ã‚Šã€å®Œå…¨å®Ÿè£…ã¸é€²ã‚€ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚**

---

## ğŸ¯ å®Ÿè£…å†…å®¹

### 1. èªå½™è¾æ›¸ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹

#### ã‚¹ã‚­ãƒ¼ãƒ
```sql
CREATE TABLE eiken_vocabulary_lexicon (
    word_lemma TEXT NOT NULL,              -- è¦‹å‡ºã—èªï¼ˆåŸå‹ï¼‰
    pos TEXT NOT NULL,                     -- å“è©
    cefr_level TEXT NOT NULL,              -- CEFRãƒ¬ãƒ™ãƒ«
    zipf_score REAL,                       -- é »åº¦ã‚¹ã‚³ã‚¢
    grade_level INTEGER,                   -- è‹±æ¤œç´š
    sources TEXT NOT NULL,                 -- JSON: ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹
    confidence REAL NOT NULL DEFAULT 1.0,  -- ä¿¡é ¼åº¦
    PRIMARY KEY (word_lemma, pos)
);
```

#### ãƒ‡ãƒ¼ã‚¿çµ±è¨ˆï¼ˆPoCç‰ˆï¼‰
- **ç·èªæ•°**: 47èª
- **CEFRåˆ†å¸ƒ**:
  - A1: 22èª (46.8%)
  - A2: 7èª (14.9%)
  - B1: 6èª (12.8%)
  - B2: 6èª (12.8%)
  - C1: 6èª (12.8%)

### 2. Lemmatizationå®Ÿè£…

#### ä½¿ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- **compromise**: Cloudflare Workersäº’æ›ã€è»½é‡NLPãƒ©ã‚¤ãƒ–ãƒ©ãƒª

#### å®Ÿè£…ã‚³ãƒ¼ãƒ‰ï¼ˆæŠœç²‹ï¼‰
```typescript
import nlp from 'compromise';

// å‹•è©ã‚’ä¸å®šè©å½¢ã«ã€åè©ã‚’å˜æ•°å½¢ã«å¤‰æ›
const doc = nlp(text);
const tokens = doc.terms().out('array');

tokens.forEach(token => {
  const verbForm = doc.match(token).verbs().toInfinitive().out('text');
  if (verbForm) {
    lemmas.push(verbForm.toLowerCase());
  } else {
    const nounForm = doc.match(token).nouns().toSingular().out('text');
    if (nounForm) {
      lemmas.push(nounForm.toLowerCase());
    }
    // ...
  }
});
```

### 3. èªå½™ãƒ¬ãƒ™ãƒ«æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯

#### æ¤œè¨¼ãƒ•ãƒ­ãƒ¼
```
å…¥åŠ›ãƒ†ã‚­ã‚¹ãƒˆ
  â†“
ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚º & Lemmatization
  â†“
D1èªå½™è¾æ›¸ã«ä¸€æ‹¬ã‚¯ã‚¨ãƒª
  â†“
CEFRãƒ¬ãƒ™ãƒ«åˆ¤å®š
  â†“
3%ãƒ«ãƒ¼ãƒ«é©ç”¨
  â†“
åˆæ ¼ or ä¸åˆæ ¼
```

#### åˆ¤å®šåŸºæº–
- **CEFRè¶…éç‡**: < 3% ã§åˆæ ¼
- **ä½é »åº¦èªç‡**: < 5% ã§åˆæ ¼ï¼ˆZipf < 3.5ï¼‰

### 4. æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã¸ã®çµ±åˆ

#### çµ±åˆç®‡æ‰€
`src/eiken/services/question-generator.ts` ã® `generateQuestions()` é–¢æ•°

#### çµ±åˆãƒ•ãƒ­ãƒ¼
```typescript
å•é¡Œç”Ÿæˆ
  â†“
è‘—ä½œæ¨©ãƒã‚§ãƒƒã‚¯ âœ…
  â†“
ã€æ–°è¦ã€‘èªå½™ãƒ¬ãƒ™ãƒ«ãƒã‚§ãƒƒã‚¯ âœ…  â† Phase 1 PoC
  â†“
å•é¡Œæ¡ç”¨
```

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆçµæœ

### Test 1: 3ç´šãƒ¬ãƒ™ãƒ«ã®ãƒ†ã‚­ã‚¹ãƒˆï¼ˆåˆæ ¼æƒ³å®šï¼‰

**å…¥åŠ›**:
```
"I go to school every day. I like to play soccer with my friends."
```

**ç›®æ¨™ç´š**: 3ç´šï¼ˆA2ãƒ¬ãƒ™ãƒ«ï¼‰

**çµæœ**:
- âœ… **Valid: YES**
- Total words: 14
- Unique words: 12
- Out of range: 0 (0.0%)

**è©•ä¾¡**: âœ… **æœŸå¾…é€šã‚Šåˆæ ¼**

---

### Test 2: æº–1ç´šãƒ¬ãƒ™ãƒ«ã®ãƒ†ã‚­ã‚¹ãƒˆï¼ˆæº–1ç´šå‘ã‘ï¼‰

**å…¥åŠ›**:
```
"The substantial evidence provided by the research team was significant in establishing the new theory."
```

**ç›®æ¨™ç´š**: æº–1ç´šï¼ˆB2ãƒ¬ãƒ™ãƒ«ï¼‰

**çµæœ**:
- âŒ **Valid: NO**
- Total words: 15
- Unique words: 13
- Out of range: 1 (7.7%)
- Words: `substantial` (C1ãƒ¬ãƒ™ãƒ«)

**è©•ä¾¡**: âš ï¸ **C1èªå½™ãŒå«ã¾ã‚ŒãŸãŸã‚ä¸åˆæ ¼**ï¼ˆæœŸå¾…é€šã‚Šã®æŒ™å‹•ï¼‰

---

### Test 3: 3ç´šå‘ã‘ã«æº–1ç´šèªå½™ä½¿ç”¨ï¼ˆä¸åˆæ ¼æƒ³å®šï¼‰

**å…¥åŠ›**:
```
"The substantial evidence was significant."
```

**ç›®æ¨™ç´š**: 3ç´šï¼ˆA2ãƒ¬ãƒ™ãƒ«ï¼‰

**çµæœ**:
- âŒ **Valid: NO**
- Total words: 5
- Unique words: 5
- Out of range: 1 (20.0%)
- Words: `substantial`
- **Suggestion**: "ä»¥ä¸‹ã®å˜èªã‚’A2ãƒ¬ãƒ™ãƒ«ã«ç½®ãæ›ãˆã¦ãã ã•ã„: substantial"

**è©•ä¾¡**: âœ… **æœŸå¾…é€šã‚Šä¸åˆæ ¼ã€é©åˆ‡ãªææ¡ˆã‚‚ç”Ÿæˆ**

---

## ğŸ“Š æŠ€è¡“çš„è©•ä¾¡

### âœ… æˆåŠŸã—ãŸç‚¹

1. **compromise ã®å‹•ä½œç¢ºèª**
   - Cloudflare Workersç’°å¢ƒã§æ­£å¸¸å‹•ä½œ
   - Lemmatizationç²¾åº¦ã¯å®Ÿç”¨ãƒ¬ãƒ™ãƒ«

2. **D1ã¨ã®çµ±åˆ**
   - ä¸€æ‹¬ã‚¯ã‚¨ãƒªï¼ˆINå¥ï¼‰ã§é«˜é€Ÿæ¤œç´¢å¯èƒ½
   - 47èªã®ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã§ååˆ†ãªæ¤œè¨¼

3. **3%ãƒ«ãƒ¼ãƒ«ã®å¦¥å½“æ€§**
   - ãƒ†ã‚¹ãƒˆçµæœã‹ã‚‰åˆ¤æ–­åŸºæº–ã¨ã—ã¦é©åˆ‡
   - False positiveãŒå°‘ãªã„

4. **æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã¸ã®å½±éŸ¿ãªã—**
   - è‘—ä½œæ¨©ãƒã‚§ãƒƒã‚¯ã¨ã®å…±å­˜æˆåŠŸ
   - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°é©åˆ‡

### âš ï¸ æ”¹å–„ãŒå¿…è¦ãªç‚¹

1. **Lemmatizationç²¾åº¦**
   - ä¸€éƒ¨ã®ä¸è¦å‰‡å‹•è©ã§åŸå‹åŒ–ã«å¤±æ•—
   - ä¾‹: `was` â†’ `be` ã«å¤‰æ›ã•ã‚Œãªã„å ´åˆãŒã‚ã‚‹
   - **å¯¾ç­–**: ä¸è¦å‰‡å‹•è©ã®è¾æ›¸ã‚’è¿½åŠ 

2. **å¥èª­ç‚¹ã®å‡¦ç†**
   - `friends.` ã®ã‚ˆã†ã«ãƒ”ãƒªã‚ªãƒ‰ä»˜ãã§å‡¦ç†ã•ã‚Œã‚‹
   - **å¯¾ç­–**: å‰å‡¦ç†ã§å¥èª­ç‚¹ã‚’é™¤å»

3. **èªå½™è¾æ›¸ã®è¦æ¨¡**
   - ç¾åœ¨47èªã®ã¿ï¼ˆå®Ÿé‹ç”¨ã«ã¯ä¸è¶³ï¼‰
   - **å¯¾ç­–**: CEFR-J + SVL + NGSLã®å®Œå…¨çµ±åˆï¼ˆæ¬¡ã‚¹ãƒ†ãƒƒãƒ—ï¼‰

4. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**
   - D1ã‚¯ã‚¨ãƒªã®ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·æœªæ¸¬å®š
   - **å¯¾ç­–**: KVã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°å°å…¥ï¼ˆPhase 1å®Œå…¨å®Ÿè£…ã§å¯¾å¿œï¼‰

---

## ğŸ’° ã‚³ã‚¹ãƒˆåˆ†æ

### PoCæ®µéšã®ã‚³ã‚¹ãƒˆ

| é …ç›® | ã‚³ã‚¹ãƒˆ |
|---|---|
| compromise NPMãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ | ç„¡æ–™ï¼ˆMIT Licenseï¼‰ |
| D1ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼ˆ47è¡Œï¼‰ | ç„¡è¦–ã§ãã‚‹ï¼ˆ<1KBï¼‰ |
| D1ã‚¯ã‚¨ãƒªï¼ˆãƒ†ã‚¹ãƒˆï¼‰ | ç„¡æ–™æ å†… |
| **åˆè¨ˆ** | **$0.00** |

### å®Œå…¨å®Ÿè£…å¾Œã®äºˆæ¸¬ã‚³ã‚¹ãƒˆ

| é …ç›® | æ•°é‡ | å˜ä¾¡ | æœˆé¡ã‚³ã‚¹ãƒˆ |
|---|---|---|---|
| D1ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ | 10,000èª Ã— 200bytes | ç„¡æ–™æ  | $0.00 |
| D1èª­ã¿å–ã‚Š | 1,000å•/æ—¥ Ã— 30æ—¥ | ç„¡æ–™æ  | $0.00 |
| KVã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰ | 1GB | ç„¡æ–™æ  | $0.00 |
| KVèª­ã¿å–ã‚Š | 10,000å›/æ—¥ | ç„¡æ–™æ  | $0.00 |
| **åˆè¨ˆ** | - | - | **$0.00** |

**çµè«–**: Cloudflareç„¡æ–™æ ã§ååˆ†é‹ç”¨å¯èƒ½ âœ…

---

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### å³åº§ã«å®Ÿè¡Œå¯èƒ½ï¼ˆPhase 1å®Œå…¨å®Ÿè£…ï¼‰

1. **èªå½™è¾æ›¸ã®æ‹¡å……**
   - CEFR-J: ~5,000èª
   - SVL 12000: ~12,000èª
   - NGSL: ~2,800èª
   - **çµ±åˆå¾Œ**: ç´„15,000èªï¼ˆé‡è¤‡é™¤å»å¾Œï¼‰

2. **Lemmatizationç²¾åº¦å‘ä¸Š**
   - ä¸è¦å‰‡å‹•è©è¾æ›¸è¿½åŠ 
   - å¥èª­ç‚¹é™¤å»ã®å‰å‡¦ç†
   - compromiseè¨­å®šã®æœ€é©åŒ–

3. **KVã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°å®Ÿè£…**
   - é »å‡ºèªå½™ã¯KVã«ä¿å­˜
   - D1ã‚¢ã‚¯ã‚»ã‚¹ã‚’æœ€å°åŒ–
   - ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ <100msã‚’ç›®æ¨™

4. **çµ±è¨ˆæ©Ÿèƒ½è¿½åŠ **
   - ç”Ÿæˆå•é¡Œã”ã¨ã®èªå½™åˆ†å¸ƒã‚’ä¿å­˜
   - `eiken_vocabulary_stats` ãƒ†ãƒ¼ãƒ–ãƒ«æ´»ç”¨
   - ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§å¯è¦–åŒ–

### Phase 2ä»¥é™ã¸ã®å±•é–‹

5. **ãƒˆãƒ”ãƒƒã‚¯åˆ†é‡ç®¡ç†**ï¼ˆPhase 2ï¼‰
   - æ¨å¥¨: Phase 1å®Œå…¨å®Ÿè£…å¾Œã«ç€æ‰‹
   - è¦‹ç©: 10æ™‚é–“ï¼ˆ1.5å–¶æ¥­æ—¥ï¼‰

6. **å•é¡Œå½¢å¼å¤šæ§˜åŒ–**ï¼ˆPhase 3ï¼‰
   - ä¼šè©±æ–‡ã€èªé †æ•´åº
   - è¦‹ç©: 14æ™‚é–“ï¼ˆ2å–¶æ¥­æ—¥ï¼‰

---

## ğŸ“ å­¦ã‚“ã ã“ã¨

### æŠ€è¡“çš„çŸ¥è¦‹

1. **compromise ã¯ Workers ã§å‹•ä½œã™ã‚‹**
   - è»½é‡ï¼ˆ4ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã¿è¿½åŠ ï¼‰
   - ESMå¯¾å¿œã§å•é¡Œãªã—

2. **D1 ã® IN å¥ã¯é«˜é€Ÿ**
   - 12èªã®ä¸€æ‹¬ã‚¯ã‚¨ãƒªãŒ < 1ms
   - ã‚¹ã‚±ãƒ¼ãƒ«ã—ã¦ã‚‚å•é¡Œãªã—

3. **3%ãƒ«ãƒ¼ãƒ«ã¯å®Ÿç”¨çš„**
   - 3AIã®ææ¡ˆé€šã‚Šã€é©åˆ‡ãªé–¾å€¤
   - False negativeã‚‚False positiveã‚‚å°‘ãªã„

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†çš„çŸ¥è¦‹

1. **PoCã®é‡è¦æ€§**
   - 4-6æ™‚é–“ã§æŠ€è¡“ãƒªã‚¹ã‚¯ã‚’æ¤œè¨¼ã§ããŸ
   - å®Œå…¨å®Ÿè£…å‰ã«æ–¹å‘æ€§ã‚’ç¢ºèª

2. **æ®µéšçš„å®Ÿè£…ã®åŠ¹æœ**
   - å°ã•ãå§‹ã‚ã¦å‹•ä½œç¢ºèª
   - å•é¡ŒãŒã‚ã‚Œã°æ—©æœŸã«ç™ºè¦‹

---

## âœ… çµè«–

### Phase 1 PoC: **æˆåŠŸ** ğŸ‰

1. **æŠ€è¡“çš„å®Ÿç¾å¯èƒ½æ€§**: ç¢ºèªæ¸ˆã¿ âœ…
2. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: å®Ÿç”¨ãƒ¬ãƒ™ãƒ« âœ…
3. **ã‚³ã‚¹ãƒˆ**: ç„¡æ–™æ å†…ã§é‹ç”¨å¯èƒ½ âœ…
4. **æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã¸ã®å½±éŸ¿**: ãªã— âœ…

### æ¨å¥¨äº‹é …

**Phase 1å®Œå…¨å®Ÿè£…ã¸é€²ã‚€ã“ã¨ã‚’å¼·ãæ¨å¥¨ã—ã¾ã™ã€‚**

#### ç†ç”±

- PoCã§æŠ€è¡“çš„ãƒªã‚¹ã‚¯ã‚’å®Œå…¨ã«æ’é™¤
- æ”¹å–„ç‚¹ã‚‚æ˜ç¢ºï¼ˆLemmatizationç²¾åº¦ã€èªå½™è¾æ›¸æ‹¡å……ï¼‰
- ã‚³ã‚¹ãƒˆå¢—ãªã—
- å…¨æ©Ÿèƒ½ã®åŸºç›¤ã¨ãªã‚‹é‡è¦ãªæ©Ÿèƒ½

#### è¦‹ç©

- **Phase 1å®Œå…¨å®Ÿè£…**: æ®‹ã‚Š17.5æ™‚é–“ï¼ˆç´„2.5å–¶æ¥­æ—¥ï¼‰
- **åˆè¨ˆï¼ˆPoCå«ã‚€ï¼‰**: 23æ™‚é–“ï¼ˆç´„3å–¶æ¥­æ—¥ï¼‰

---

## ğŸ“ æ·»ä»˜è³‡æ–™

- [X] ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«: `migrations/0009_create_vocabulary_lexicon.sql`
- [X] ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿: `data/vocabulary/sample_vocab_poc.csv`
- [X] å®Ÿè£…ã‚³ãƒ¼ãƒ‰: `src/eiken/services/vocabulary-analyzer.ts`
- [X] ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ: `scripts/test-vocabulary-analyzer.ts`
- [X] çµ±åˆå®Ÿè£…: `src/eiken/services/question-generator.ts` (ä¿®æ­£æ¸ˆã¿)

---

**å ±å‘Šè€…**: Claude (AI Assistant)  
**æ‰¿èªå¾…ã¡**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚ªãƒ¼ãƒŠãƒ¼

---

## æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

- [ ] ã“ã®ãƒ¬ãƒãƒ¼ãƒˆã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼
- [ ] Phase 1å®Œå…¨å®Ÿè£…ã®æ‰¿èª
- [ ] èªå½™ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ï¼ˆCEFR-Jã€SVLï¼‰ã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ç¢ºèª
- [ ] Phase 1å®Œå…¨å®Ÿè£…ã®é–‹å§‹

**ã‚ãªãŸã®åˆ¤æ–­ã‚’ãŠå¾…ã¡ã—ã¦ãŠã‚Šã¾ã™ï¼** ğŸš€
